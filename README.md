# skia-binaries

Documents how to build Skia and its results (since December 2019, and m70).

## Background.

During the development for [SVG Native Viewer](https://github.com/adobe/svg-native-viewer),
I had to build Skia for GNU/Linux, macOS and Windows.

Building Skia for GNU/Linux and macOS is very straight-forward process,
but that for Windows is very painful experience.

In addition, their recommended building procedure for Windows is often
changed, and their document is hard to spot what is the recommended process.

Here, I provide some notes how I build it and script(s) reduce the typing,
and my result.

## Existing projects with similar purpose.

@nachooya has a project [libskia-dev](https://github.com/nachooya/libskia-dev),
a collection of shell script to build Skia for Ubuntu, macOS and Windows.
But it is not updated since 2014, and Google replaced their meta-build system
"gyp" in those days by new "gn".

## Environment I use for this project.

I use a [VM provided for the developers from Microsoft](https://developer.microsoft.com/ja-jp/windows/downloads/virtual-machines),
running on VirtualBox.

It already includes:
* WSL (Windows Subsystem for Linux) and Ubuntu for WSL,
* Microsoft VisualStudio Community Edition.

The role of the tools are following:
* Compiling & linking are managed by Ninja (as the cases of Linux and macOS), not by VS IDE.
* Input files for Ninja are generated by "gn" running on WSL.
* Ninja itself is invoked by WSL, as a Linux process.
* Clang compiler is invoked by Ninja, but as a Win32 process (WSL's bash can invoke Windows binary executables).

## Preparations.

### C++ SDK might be optional even if VisualStudio is preinstalled.
VisualStudio is installed in VM, but C++ SDK is not installed, you should install by yourself,
after making Microsoft account. Without Microsoft account (or you've never logged in
from the VM), VS would complain as it is not licensed yet.

Microsoft provides Clang toolchain which would be working under VisualStudio,
but I installed self-standing LLVM 9.0 for Win32 (out-of MSVC), into C:\Program Files.

### Make NTFS symbolic links to minimize the possibility of incorrect tokenized pathnames.
As other standard Unix environment, the spaces in the pathname make Google's meta-
building system confused often. Thus, I suggest to make "symbolic-link" on NTFS,
to make a pathname without space (e.g. "Program Files" and "ProgramFiles"), like this,
in CMD.COM with administrator priviledge.

```
C:\WINDOWS\system32>cd C:\
C:\>mklink /D "Program Files" "ProgramFiles"
```

There would be "Program Files", "Program Files (x86)", "Microsoft SDKs",
"Microsoft Visual Studio", "Windows SDKs", ... not so many.

### Google's meta-building system is very sticking to Python2.
WSL provided in the VM has only Python3, but Google's meta-building system is very
sticking to Python2.7. I install python2.7 onto WSL (not native Python2.7 on Win32).

After the installation of Python2.7, you should create several symbolic links in
some directory of your own PATH; python2 and python. It means the default Python
interpreter (when you're building Skia) should be Python 2 X-(



